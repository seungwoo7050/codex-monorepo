# infra-inception v0.4.0 - 모니터링 스택 설계

## 목표
- 최소 Prometheus + Grafana 스택을 추가해 nginx/app 지표를 관찰한다.
- 기존 Inception 구성(app/db/redis/nginx)에 영향을 주지 않는 가벼운 추가 컴포넌트를 제공한다.

## 외부 동작
- `docker compose up -d` 실행 시 prometheus(9090), grafana(3000) 서비스가 함께 기동된다.
- Prometheus는 nginx/app의 `/metrics` 엔드포인트를 스크랩하도록 기본 설정되어 있다.
- Grafana는 기본 관리자 비밀번호 `admin123`으로 접속해 수동으로 데이터 소스를 추가할 수 있다.

## 내부 설계
- `docker-compose.yml`에 `prometheus`, `grafana` 서비스를 추가하고 필요한 포트를 노출한다.
- Prometheus 설정 파일(`services/monitoring/prometheus.yml`)에 static_configs로 nginx, app를 등록한다.
- Grafana 데이터는 `grafana_data` 볼륨으로 영구화한다.

## 테스트 전략
- `tests/compose_lint.sh`에 prometheus/grafana 서비스 존재 여부와 설정 파일 경로 검증을 추가했다.
- 구성 파일 존재 여부만 확인하며, 런타임 접근성은 수동 확인으로 유지한다.

## 추후 과제
- nginx/app에서 실제 `/metrics` 엔드포인트를 제공하도록 Exporter 연동을 추가할 수 있다.
- Grafana 프로비저닝 스크립트로 대시보드/데이터소스 자동화를 고려한다.
