# infra-inception v0.1.0 - App + DB 스택 설계

## 개요
- 단순 웹 앱 컨테이너와 MariaDB 데이터베이스를 docker-compose로 묶는다.
- DB 초기화 스크립트를 통해 기본 테이블을 준비한다.

## 목표 및 범위
- 서비스: `app`, `db` 두 가지.
- 포트: 앱 8085, DB 3307(호스트 기준) 노출.
- 환경 변수로 DB 접속 정보를 전달한다.
- init.sql을 통해 헬스 체크용 테이블 생성.

## 외부 동작
- `docker compose up -d` 실행 시 두 컨테이너가 기동된다.
- `curl http://localhost:8085`로 앱 상태와 DB 호스트 정보를 확인할 수 있다.
- DB 컨테이너는 init.sql을 읽어 health_check 테이블을 만든다.

## 내부 설계
- `services/app/Dockerfile`: python:3.11-slim 기반, http.server를 사용한 단순 핸들러 제공.
- `services/app/main.py`: GET 요청마다 버전 문자열과 DB_HOST 환경 변수를 출력.
- `docker-compose.yml`: app은 db에 의존하며 환경 변수로 접속 정보 전달, db는 init.sql 마운트.
- `services/db/init.sql`: health_check 테이블 생성 및 초기 레코드 삽입.

## 테스트 전략
- tests/compose_lint.sh
  - docker-compose.yml에 app/db 서비스가 있는지 grep 확인.
  - init.sql 존재 여부 검사.

## 실행 참고
- `docker compose up -d`로 기동, `docker compose down`으로 종료.
- 포트 충돌 시 docker-compose.yml의 포트를 수정하거나 환경 변수로 전달한다.
