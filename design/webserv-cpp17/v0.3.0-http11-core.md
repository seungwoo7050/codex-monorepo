# webserv-cpp17 v0.3.0 – HTTP/1.1 핵심 동작

## 목표
- HTTP/1.1에서 필수인 Host 헤더를 검증한다.
- keep-alive 연결을 유지하며 동일 연결에서 여러 요청을 처리한다.

## 범위
- 요청 라인과 헤더를 간단히 파싱해 메서드/경로/버전을 추출한다.
- Host 헤더가 없는 HTTP/1.1 요청은 400 응답으로 종료한다.
- Connection 헤더를 확인해 keep-alive/close 여부를 판단하고 응답 헤더에 반영한다.
- 최대 요청 수를 초과하면 서버를 종료하고 열린 연결을 정리한다.

## 구현 메모
- `parseHttpRequest`가 `\r\n\r\n` 전까지 헤더를 파싱해 소문자 키 맵으로 저장한다.
- `handleConnections` 루프에서 요청이 준비될 때마다 응답을 생성하며, keep-alive가 false면 즉시 연결을 닫는다.
- 응답 본문에는 수신한 Host 값과 연결 상태를 포함해 테스트 용이성을 높였다.
- 타임아웃은 기존 1.5초 유지, select 기반 단일 스레드 구조를 유지했다.

## 테스트
- `tests/test_webserv_host_header.sh`: Host 누락 시 400/Missing Host 메시지를 확인.
- `tests/test_webserv_keepalive.sh`: 하나의 연결에서 두 요청을 보내고 keep-alive 헤더와 응답 개수를 검증.
- `tests/test_webserv.sh`, `tests/test_webserv_multi.sh`: 기본 응답과 최대 요청 종료 동작을 회귀 확인.

## 후속 과제
- 요청 본문 및 Content-Length/Chunked 지원은 v0.4.0에서 다룬다.
- 설정 파일 기반의 가상호스트/라우팅 확장은 이후 버전에서 설계한다.
